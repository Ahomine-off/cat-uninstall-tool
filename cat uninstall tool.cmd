@echo off
chcp 65001
powershell -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Windows.Forms; $form = New-Object Windows.Forms.Form; $form.Text = 'CatUninstaller v8'; $form.Width = 650; $form.Height = 480; $form.StartPosition = 'CenterScreen'; $listbox = New-Object Windows.Forms.ListBox; $listbox.Width = 600; $listbox.Height = 270; $listbox.Top = 20; $listbox.Left = 20; $listbox.Sorted = $true; $form.Controls.Add($listbox); $apps = @(); $reg = Get-ItemProperty 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*','HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' | Where-Object { $_.DisplayName -and $_.UninstallString }; foreach ($a in $reg) { $apps += [PSCustomObject]@{ Name = $a.DisplayName; Type = 'REG'; Cmd = $a.UninstallString } }; $uwp = Get-AppxPackage | Where-Object { $_.Name -and $_.PackageFullName } | ForEach-Object { $apps += [PSCustomObject]@{ Name = $_.Name; Type = 'UWP'; Cmd = $_.PackageFullName } }; $listbox.Items.AddRange($apps.Name); $btnUninstall = New-Object Windows.Forms.Button; $btnUninstall.Text = 'D√©sinstaller'; $btnUninstall.Top = 310; $btnUninstall.Left = 20; $btnUninstall.Width = 120; $btnUninstall.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $app = $apps | Where-Object { $_.Name -eq $sel }; $cmd = $app.Cmd; if ($app.Type -eq 'REG') { if ($cmd -match '/I{(.+?)}') { $guid = $Matches[1]; Start-Process msiexec -ArgumentList \"/x{$guid} /quiet\" -WindowStyle Hidden } elseif (Test-Path $cmd) { Start-Process -FilePath $cmd -ArgumentList '/S','/quiet' -WindowStyle Hidden } else { Start-Process -FilePath 'cmd.exe' -ArgumentList \"/c $cmd\" -WindowStyle Hidden } } elseif ($app.Type -eq 'UWP') { Remove-AppxPackage -Package $cmd -ErrorAction SilentlyContinue }; [System.Windows.Forms.MessageBox]::Show(\"App d√©sinstall√©e !\", \"‚úÖ\") } }); $form.Controls.Add($btnUninstall); $btnClean = New-Object Windows.Forms.Button; $btnClean.Text = 'Retirer toutes les traces'; $btnClean.Top = 310; $btnClean.Left = 160; $btnClean.Width = 180; $btnClean.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $scanDirs = @(\"C:\Program Files\", \"C:\Program Files (x86)\", \"C:\ProgramData\", \"$env:APPDATA\", \"$env:LOCALAPPDATA\", \"$env:TEMP\", \"$env:USERPROFILE\AppData\Local\Packages\"); foreach ($dir in $scanDirs) { Get-ChildItem -Path $dir -Recurse -Directory -ErrorAction SilentlyContinue | Where-Object { $_.FullName -like \"*$sel*\" } | ForEach-Object { Remove-Item $_.FullName -Recurse -Force -ErrorAction SilentlyContinue } }; $scanKeys = @(\"HKCU:\Software\", \"HKLM:\Software\", \"HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\", \"HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\"); foreach ($key in $scanKeys) { Get-ChildItem $key -ErrorAction SilentlyContinue | Where-Object { $_.PSChildName -like \"*$sel*\" } | ForEach-Object { Remove-Item -Path $_.PsPath -Recurse -Force -ErrorAction SilentlyContinue } }; [System.Windows.Forms.MessageBox]::Show(\"Traces supprim√©es pour '$sel'\", \"üßπ\") } }); $form.Controls.Add($btnClean); $form.ShowDialog();"
