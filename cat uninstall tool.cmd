@echo off
chcp 65001
powershell -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Windows.Forms; $form = New-Object Windows.Forms.Form; $form.Text = 'CatUninstaller v5'; $form.Width = 600; $form.Height = 400; $form.StartPosition = 'CenterScreen'; $listbox = New-Object Windows.Forms.ListBox; $listbox.Width = 540; $listbox.Height = 220; $listbox.Top = 20; $listbox.Left = 20; $listbox.Sorted = $true; $form.Controls.Add($listbox); $apps = @(); $regApps = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*,HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Where-Object { $_.DisplayName } | Select-Object DisplayName, UninstallString; foreach ($a in $regApps) { $apps += [PSCustomObject]@{ Name = $a.DisplayName; Type = 'REG'; Info = $a.UninstallString } }; $uwpApps = Get-AppxPackage | Select-Object Name, PackageFullName; foreach ($u in $uwpApps) { $apps += [PSCustomObject]@{ Name = $u.Name; Type = 'UWP'; Info = $u.PackageFullName } }; $listbox.Items.AddRange($apps.Name); $btnUninstall = New-Object Windows.Forms.Button; $btnUninstall.Text = 'Désinstaller'; $btnUninstall.Top = 260; $btnUninstall.Left = 20; $btnUninstall.Width = 120; $btnUninstall.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $target = $apps | Where-Object { $_.Name -eq $sel }; if ($target.Type -eq 'REG') { Start-Process -FilePath $target.Info -ArgumentList '/quiet' -WindowStyle Hidden -ErrorAction SilentlyContinue } elseif ($target.Type -eq 'UWP') { Remove-AppxPackage -Package $target.Info -ErrorAction SilentlyContinue }; [System.Windows.Forms.MessageBox]::Show('Désinstallation terminée.', 'Succès') } }); $form.Controls.Add($btnUninstall); $btnClean = New-Object Windows.Forms.Button; $btnClean.Text = 'Retirer toutes les traces'; $btnClean.Top = 260; $btnClean.Left = 160; $btnClean.Width = 180; $btnClean.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { Remove-Item \"C:\Program Files\$sel\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"C:\Program Files (x86)\$sel\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"C:\ProgramData\$sel\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"$env:APPDATA\$sel\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"$env:LOCALAPPDATA\$sel\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item -Path HKCU:\Software\$sel -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item -Path HKLM:\Software\$sel -Recurse -Force -ErrorAction SilentlyContinue; [System.Windows.Forms.MessageBox]::Show('Traces supprimées.', 'Nettoyage terminé') } }); $form.Controls.Add($btnClean); $form.ShowDialog();"
