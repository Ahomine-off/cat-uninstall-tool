@echo off
chcp 65001
title CatUninstaller v3
echo Lancement du désinstalleur félin...

powershell -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Windows.Forms; $form = New-Object Windows.Forms.Form; $form.Text = 'CatUninstaller'; $form.Width = 600; $form.Height = 400; $form.StartPosition = 'CenterScreen'; $listbox = New-Object Windows.Forms.ListBox; $listbox.Width = 540; $listbox.Height = 220; $listbox.Top = 20; $listbox.Left = 20; $listbox.Sorted = $true; $form.Controls.Add($listbox); $apps1 = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*,HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Where-Object { $_.DisplayName -ne $null } | Select-Object -ExpandProperty DisplayName; $apps2 = Get-AppxPackage | Select-Object -ExpandProperty Name; $allApps = $apps1 + $apps2 | Sort-Object; $listbox.Items.AddRange($allApps); $btnUninstall = New-Object Windows.Forms.Button; $btnUninstall.Text = 'Désinstaller'; $btnUninstall.Top = 260; $btnUninstall.Left = 20; $btnUninstall.Width = 120; $btnUninstall.Add_Click({ $app = $listbox.SelectedItem; if ($app) { try { Get-WmiObject Win32_Product | Where-Object { $_.Name -eq $app } | ForEach-Object { $_.Uninstall() }; Get-AppxPackage -Name $app | Remove-AppxPackage -ErrorAction SilentlyContinue; [System.Windows.Forms.MessageBox]::Show('Désinstallation terminée.', 'Succès') } catch { [System.Windows.Forms.MessageBox]::Show('Échec de la désinstallation.', 'Erreur') } } }); $form.Controls.Add($btnUninstall); $btnClean = New-Object Windows.Forms.Button; $btnClean.Text = 'Retirer toutes les traces'; $btnClean.Top = 260; $btnClean.Left = 160; $btnClean.Width = 180; $btnClean.Add_Click({ $app = $listbox.SelectedItem; if ($app) { Remove-Item \"C:\Program Files\$app\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"C:\Program Files (x86)\$app\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"C:\ProgramData\$app\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"$env:APPDATA\$app\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item \"$env:LOCALAPPDATA\$app\" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item -Path HKCU:\Software\$app -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item -Path HKLM:\Software\$app -Recurse -Force -ErrorAction SilentlyContinue; [System.Windows.Forms.MessageBox]::Show('Traces supprimées.', 'Nettoyage') } }); $form.Controls.Add($btnClean); $form.ShowDialog();"