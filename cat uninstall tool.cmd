@echo off
chcp 65001
powershell -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Windows.Forms; $form = New-Object Windows.Forms.Form; $form.Text = 'CatUninstaller v6'; $form.Width = 600; $form.Height = 430; $form.StartPosition = 'CenterScreen'; $listbox = New-Object Windows.Forms.ListBox; $listbox.Width = 540; $listbox.Height = 240; $listbox.Top = 20; $listbox.Left = 20; $listbox.Sorted = $true; $form.Controls.Add($listbox); $apps = @(); $regApps = Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*,HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Where-Object { $_.DisplayName -and $_.UninstallString } | Select-Object DisplayName, UninstallString; foreach ($a in $regApps) { $apps += [PSCustomObject]@{ Name = $a.DisplayName; Type = 'REG'; Uninstall = $a.UninstallString } }; $uwpApps = Get-AppxPackage | Select-Object Name, PackageFullName; foreach ($u in $uwpApps) { $apps += [PSCustomObject]@{ Name = $u.Name; Type = 'UWP'; Uninstall = $u.PackageFullName } }; $listbox.Items.AddRange($apps.Name); $btnUninstall = New-Object Windows.Forms.Button; $btnUninstall.Text = 'Désinstaller'; $btnUninstall.Top = 280; $btnUninstall.Left = 20; $btnUninstall.Width = 120; $btnUninstall.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $target = $apps | Where-Object { $_.Name -eq $sel }; if ($target.Type -eq 'REG') { Start-Process -FilePath 'cmd.exe' -ArgumentList \"/c\", $target.Uninstall -WindowStyle Hidden -ErrorAction SilentlyContinue } elseif ($target.Type -eq 'UWP') { Remove-AppxPackage -Package $target.Uninstall -ErrorAction SilentlyContinue }; [System.Windows.Forms.MessageBox]::Show(\"Désinstallation effectuée pour '$sel'\", \"Succès\") } }); $form.Controls.Add($btnUninstall); $btnClean = New-Object Windows.Forms.Button; $btnClean.Text = 'Retirer toutes les traces'; $btnClean.Top = 280; $btnClean.Left = 160; $btnClean.Width = 180; $btnClean.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $paths = @(\"C:\Program Files\$sel\", \"C:\Program Files (x86)\$sel\", \"C:\ProgramData\$sel\", \"$env:APPDATA\$sel\", \"$env:LOCALAPPDATA\$sel\"); foreach ($p in $paths) { Remove-Item $p -Recurse -Force -ErrorAction SilentlyContinue }; $keys = @(\"HKCU:\Software\$sel\", \"HKLM:\Software\$sel\"); foreach ($k in $keys) { Remove-Item -Path $k -Recurse -Force -ErrorAction SilentlyContinue }; [System.Windows.Forms.MessageBox]::Show(\"Traces supprimées pour '$sel'\", \"Nettoyage\") } }); $form.Controls.Add($btnClean); $form.ShowDialog();"
