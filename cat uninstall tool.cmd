@echo off
chcp 65001
powershell -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Add-Type -AssemblyName System.Windows.Forms; $form = New-Object Windows.Forms.Form; $form.Text = 'CatUninstaller v7'; $form.Width = 640; $form.Height = 470; $form.StartPosition = 'CenterScreen'; $listbox = New-Object Windows.Forms.ListBox; $listbox.Width = 580; $listbox.Height = 260; $listbox.Top = 20; $listbox.Left = 20; $listbox.Sorted = $true; $form.Controls.Add($listbox); $apps = @(); $reg = Get-ItemProperty 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*','HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' | Where-Object { $_.DisplayName -and $_.UninstallString }; foreach ($a in $reg) { $apps += [PSCustomObject]@{ Name = $a.DisplayName; Type = 'REG'; Cmd = $a.UninstallString } }; $uwp = Get-AppxPackage | Where-Object { $_.Name -and $_.PackageFullName } | ForEach-Object { $apps += [PSCustomObject]@{ Name = $_.Name; Type = 'UWP'; Cmd = $_.PackageFullName } }; $listbox.Items.AddRange($apps.Name); $btnUninstall = New-Object Windows.Forms.Button; $btnUninstall.Text = 'D√©sinstaller'; $btnUninstall.Top = 300; $btnUninstall.Left = 20; $btnUninstall.Width = 120; $btnUninstall.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $app = $apps | Where-Object { $_.Name -eq $sel }; if ($app.Type -eq 'REG') { try { Start-Process -FilePath 'cmd.exe' -ArgumentList '/c', $app.Cmd -WindowStyle Hidden } catch { [System.Windows.Forms.MessageBox]::Show(\"Erreur d√©sinstallation.\", \"‚ùå\") } } elseif ($app.Type -eq 'UWP') { try { Remove-AppxPackage -Package $app.Cmd -ErrorAction SilentlyContinue } catch { [System.Windows.Forms.MessageBox]::Show(\"Erreur UWP.\", \"‚ùå\") } }; [System.Windows.Forms.MessageBox]::Show(\"App d√©sinstall√©e !\", \"‚úÖ\") } }); $form.Controls.Add($btnUninstall); $btnClean = New-Object Windows.Forms.Button; $btnClean.Text = 'Retirer toutes les traces'; $btnClean.Top = 300; $btnClean.Left = 160; $btnClean.Width = 180; $btnClean.Add_Click({ $sel = $listbox.SelectedItem; if ($sel) { $paths = @(\"C:\Program Files\", \"C:\Program Files (x86)\", \"C:\ProgramData\", \"$env:APPDATA\", \"$env:LOCALAPPDATA\"); foreach ($p in $paths) { Get-ChildItem -Path $p -Recurse -Directory -ErrorAction SilentlyContinue | Where-Object { $_.Name -like \"*$sel*\" } | ForEach-Object { Remove-Item $_.FullName -Recurse -Force -ErrorAction SilentlyContinue } }; $keys = @(\"HKCU:\Software\", \"HKLM:\Software\"); foreach ($k in $keys) { Get-ChildItem $k -ErrorAction SilentlyContinue | Where-Object { $_.PSChildName -like \"*$sel*\" } | ForEach-Object { Remove-Item -Path $_.PsPath -Recurse -Force -ErrorAction SilentlyContinue } }; [System.Windows.Forms.MessageBox]::Show(\"Traces supprim√©es !\", \"üßπ\") } }); $form.Controls.Add($btnClean); $form.ShowDialog();"
